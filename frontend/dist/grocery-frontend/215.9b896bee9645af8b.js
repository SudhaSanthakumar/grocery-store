"use strict";(self.webpackChunkgrocery_frontend=self.webpackChunkgrocery_frontend||[]).push([[215],{9215:(x,m,i)=>{i.r(m),i.d(m,{CheckoutComponent:()=>I});var l=i(177),a=i(4341),e=i(4438),u=i(6868),_=i(8674),f=i(1069);function p(o,c){1&o&&(e.j41(0,"div",38),e.EFF(1," Please provide your full name. "),e.k0s())}function h(o,c){1&o&&(e.j41(0,"div",38),e.EFF(1," Please provide your phone number. "),e.k0s())}function g(o,c){1&o&&(e.j41(0,"div",38),e.EFF(1," Please provide your delivery address. "),e.k0s())}function v(o,c){1&o&&e.nrm(0,"span",39)}function k(o,c){1&o&&e.nrm(0,"i",40)}function F(o,c){if(1&o){const t=e.RV6();e.j41(0,"form",22,0),e.bIt("ngSubmit",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.placeOrder())}),e.j41(2,"div",4)(3,"div",23)(4,"label",24),e.EFF(5,"Full Name *"),e.k0s(),e.j41(6,"input",25,1),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.customerDetails.customerName,r)||(s.customerDetails.customerName=r),e.Njj(r)}),e.k0s(),e.DNE(8,p,2,0,"div",26),e.k0s(),e.j41(9,"div",23)(10,"label",27),e.EFF(11,"Phone Number *"),e.k0s(),e.j41(12,"input",28,2),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.customerDetails.customerPhone,r)||(s.customerDetails.customerPhone=r),e.Njj(r)}),e.k0s(),e.DNE(14,h,2,0,"div",26),e.k0s()(),e.j41(15,"div",29)(16,"label",30),e.EFF(17,"Delivery Address *"),e.k0s(),e.j41(18,"textarea",31,3),e.mxI("ngModelChange",function(r){e.eBV(t);const s=e.XpG();return e.DH7(s.customerDetails.customerAddress,r)||(s.customerDetails.customerAddress=r),e.Njj(r)}),e.k0s(),e.DNE(20,g,2,0,"div",26),e.k0s(),e.j41(21,"div",32)(22,"button",33),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.goBack())}),e.nrm(23,"i",34),e.EFF(24,"Back to Cart "),e.k0s(),e.j41(25,"button",35),e.DNE(26,v,1,0,"span",36)(27,k,1,0,"i",37),e.EFF(28),e.k0s()()()}if(2&o){const t=e.sdS(1),n=e.sdS(7),r=e.sdS(13),s=e.sdS(19),d=e.XpG();e.R7$(6),e.R50("ngModel",d.customerDetails.customerName),e.R7$(2),e.Y8G("ngIf",n.invalid&&n.touched),e.R7$(4),e.R50("ngModel",d.customerDetails.customerPhone),e.R7$(2),e.Y8G("ngIf",r.invalid&&r.touched),e.R7$(4),e.R50("ngModel",d.customerDetails.customerAddress),e.R7$(2),e.Y8G("ngIf",s.invalid&&s.touched),e.R7$(5),e.Y8G("disabled",t.invalid||d.placing),e.R7$(),e.Y8G("ngIf",d.placing),e.R7$(),e.Y8G("ngIf",!d.placing),e.R7$(),e.SpI(" ",d.placing?"Placing Order...":"Place Order"," ")}}function C(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",41),e.nrm(1,"i",42),e.j41(2,"h3",43),e.EFF(3,"Order Placed Successfully!"),e.k0s(),e.j41(4,"p",44),e.EFF(5),e.k0s(),e.j41(6,"p",44),e.EFF(7),e.k0s(),e.j41(8,"div",45)(9,"button",46),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.viewOrder())}),e.nrm(10,"i",47),e.EFF(11,"View Order Details "),e.k0s(),e.j41(12,"button",48),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.continueShopping())}),e.nrm(13,"i",49),e.EFF(14,"Continue Shopping "),e.k0s()()()}if(2&o){const t=e.XpG();e.R7$(5),e.SpI("Your order #",null==t.placedOrder?null:t.placedOrder.id," has been confirmed."),e.R7$(2),e.SpI("Estimated delivery: ",t.getFormattedDate(null==t.placedOrder?null:t.placedOrder.estimatedDelivery),"")}}function E(o,c){1&o&&(e.j41(0,"div",50),e.nrm(1,"i",51),e.j41(2,"p"),e.EFF(3,"Your cart is empty"),e.k0s()())}function b(o,c){if(1&o&&(e.j41(0,"div",53)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.Lme("",t.groceryItem.name," (",t.quantity,"x)"),e.R7$(2),e.SpI("$",t.totalPrice.toFixed(2),"")}}function j(o,c){if(1&o&&(e.j41(0,"div"),e.DNE(1,b,5,3,"div",52),e.nrm(2,"hr"),e.j41(3,"div",53)(4,"span"),e.EFF(5,"Subtotal:"),e.k0s(),e.j41(6,"span"),e.EFF(7),e.k0s()(),e.j41(8,"div",53)(9,"span"),e.EFF(10,"Delivery Fee:"),e.k0s(),e.j41(11,"span"),e.EFF(12,"$2.99"),e.k0s()(),e.nrm(13,"hr"),e.j41(14,"div",32)(15,"strong"),e.EFF(16,"Total:"),e.k0s(),e.j41(17,"strong",54),e.EFF(18),e.k0s()()()),2&o){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.cartItems),e.R7$(6),e.SpI("$",t.cartTotal.toFixed(2),""),e.R7$(11),e.SpI("$",(t.cartTotal+2.99).toFixed(2),"")}}let I=(()=>{class o{constructor(t,n,r){this.cartService=t,this.orderService=n,this.router=r,this.cartItems=[],this.cartTotal=0,this.customerDetails={customerName:"",customerAddress:"",customerPhone:""},this.placing=!1,this.orderPlaced=!1,this.placedOrder=null}ngOnInit(){this.loadCartItems()}loadCartItems(){this.cartService.getCartItems().subscribe({next:t=>{this.cartItems=t,this.calculateTotal(),0===t.length&&this.router.navigate(["/cart"])},error:t=>{console.error("Error loading cart items:",t)}})}calculateTotal(){this.cartTotal=this.cartItems.reduce((t,n)=>t+n.totalPrice,0)}placeOrder(){if(0===this.cartItems.length)return;this.placing=!0;const t=this.cartService.getSessionId();this.orderService.placeOrder(t,this.customerDetails).subscribe({next:n=>{this.placedOrder=n,this.orderPlaced=!0,this.placing=!1},error:n=>{console.error("Error placing order:",n),this.placing=!1,alert("Failed to place order. Please try again.")}})}getFormattedDate(t){return t?new Date(t).toLocaleString():""}goBack(){this.router.navigate(["/cart"])}viewOrder(){this.placedOrder&&this.router.navigate(["/orders",this.placedOrder.id])}continueShopping(){this.router.navigate(["/products"])}static{this.\u0275fac=function(n){return new(n||o)(e.rXU(u.m),e.rXU(_.Q),e.rXU(f.Ix))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-checkout"]],standalone:!0,features:[e.aNF],decls:31,vars:4,consts:[["checkoutForm","ngForm"],["customerName","ngModel"],["customerPhone","ngModel"],["customerAddress","ngModel"],[1,"row"],[1,"col-md-8"],[1,"fas","fa-credit-card","me-2"],[1,"card"],[1,"card-header"],[1,"mb-0"],[1,"card-body"],[3,"ngSubmit",4,"ngIf"],["class","text-center py-4",4,"ngIf"],[1,"col-md-4"],["class","text-center text-muted",4,"ngIf"],[4,"ngIf"],[1,"card","mt-3"],[1,"fas","fa-truck","me-2"],[1,"small","text-muted","mb-1"],[1,"fas","fa-clock","me-1"],[1,"small","text-muted","mb-0"],[1,"fas","fa-shield-alt","me-1"],[3,"ngSubmit"],[1,"col-md-6","mb-3"],["for","customerName",1,"form-label"],["type","text","id","customerName","name","customerName","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","invalid-feedback",4,"ngIf"],["for","customerPhone",1,"form-label"],["type","tel","id","customerPhone","name","customerPhone","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"mb-3"],["for","customerAddress",1,"form-label"],["id","customerAddress","name","customerAddress","rows","3","required","","placeholder","Enter your complete delivery address...",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left","me-2"],["type","submit",1,"btn","btn-success",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-check me-2",4,"ngIf"],[1,"invalid-feedback"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-check","me-2"],[1,"text-center","py-4"],[1,"fas","fa-check-circle","text-success",2,"font-size","4rem"],[1,"mt-3","text-success"],[1,"text-muted"],[1,"mt-4"],[1,"btn","btn-primary","me-2",3,"click"],[1,"fas","fa-receipt","me-2"],[1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-store","me-2"],[1,"text-center","text-muted"],[1,"fas","fa-shopping-cart","mb-2",2,"font-size","2rem"],["class","d-flex justify-content-between mb-2",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between","mb-2"],[1,"text-success"]],template:function(n,r){1&n&&(e.j41(0,"div",4)(1,"div",5)(2,"h2"),e.nrm(3,"i",6),e.EFF(4,"Checkout"),e.k0s(),e.j41(5,"div",7)(6,"div",8)(7,"h5",9),e.EFF(8,"Customer Information"),e.k0s()(),e.j41(9,"div",10),e.DNE(10,F,29,10,"form",11)(11,C,15,2,"div",12),e.k0s()()(),e.j41(12,"div",13)(13,"div",7)(14,"div",8)(15,"h5",9),e.EFF(16,"Order Summary"),e.k0s()(),e.j41(17,"div",10),e.DNE(18,E,4,0,"div",14)(19,j,19,3,"div",15),e.k0s()(),e.j41(20,"div",16)(21,"div",10)(22,"h6"),e.nrm(23,"i",17),e.EFF(24,"Delivery Information"),e.k0s(),e.j41(25,"p",18),e.nrm(26,"i",19),e.EFF(27," Estimated delivery: 1-2 hours "),e.k0s(),e.j41(28,"p",20),e.nrm(29,"i",21),e.EFF(30," Safe and contactless delivery "),e.k0s()()()()()),2&n&&(e.R7$(10),e.Y8G("ngIf",!r.orderPlaced),e.R7$(),e.Y8G("ngIf",r.orderPlaced),e.R7$(7),e.Y8G("ngIf",0===r.cartItems.length),e.R7$(),e.Y8G("ngIf",r.cartItems.length>0))},dependencies:[l.MD,l.Sq,l.bT,a.YN,a.qT,a.me,a.BC,a.cb,a.YS,a.vS,a.cV],encapsulation:2})}}return o})()}}]);